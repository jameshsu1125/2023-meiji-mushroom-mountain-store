"use strict";(self.webpackChunk_2023_meiji_mushroom_mountain_store=self.webpackChunk_2023_meiji_mushroom_mountain_store||[]).push([[611,146],{3611:function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var i=o(7294),n={steps:0},r=(0,i.createContext)(n),a=o(5146),s=o(5893),c=(0,i.memo)((function(){var e=(0,i.useState)(n);return(0,s.jsx)(r.Provider,{value:e,children:(0,s.jsx)("div",{className:"Game",children:(0,s.jsx)(a.default,{})})})}))},5146:function(e,t,o){o.r(t),o.d(t,{default:function(){return J}});var i=o(885),n=o(7294),r=o(5671),a=o(3144),s=o(4376),c=o(1214),h=o(4942),u=o(2982),l=o(3687),d=o(4570),f=o(2520),m=o(9477);function y(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}var p={camera:{fov:50,far:75,type:o(5444).CameraType.perspective},sky:{enabled:!0,turbidity:3.6,rayleigh:.165,mieCoefficient:0,mieDirectionalG:.768,inclination:.25,azimuth:.25},controls:{distance:{min:13,max:30},polar:{min:-70,max:70},azimuth:{min:-1/0,max:1/0},default:{polar:50,azimuth:35},offsetAzimuth:0,enabled:!0,panEasing:100},light:{ambient:{color:13163508,intensity:1},point:{color:16042184,intensity:.9,distance:100,decay:.5,position:{x:0,y:8,z:0}},shadowMapSize:1024,debug:!0},renderer:{alpha:!1,shadowType:m.ntZ,exposure:1,outputEncoding:m.knz,physicallyCorrectLights:!1},physics:!0,stats:!0},b={number:0,index:0,hasItem:""},v={totalDuration:3e4,frameOfCountDown:3e3,maxMushroom:3,cubes:(0,u.Z)(new Array(9).keys()).map((function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?y(Object(o),!0).forEach((function(t){(0,h.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},b);return t.number=5+Math.floor(5*Math.random()),t.index=e,t}))},w=o(46),g=o(3431),x=o.n(g),O=function(e){var t="inCirc"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inCirc")?w.DO.inCirc:w.DO.linear,o=x()(t[0],t[1],t[2],t[3]);return Math.floor(o(e/v.totalDuration)*v.totalDuration/1e3)},z=function(e){for(var t,o=(0,u.Z)(e),i=e.length;0!==i;){t=Math.floor(Math.random()*i),i--;var n=[o[t],o[i]];o[i]=n[0],o[t]=n[1]}return o},k=o.p+"bundle/model/bamboo.glb";function P(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function M(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?P(Object(o),!0).forEach((function(t){(0,h.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):P(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var j=function(){function e(t){var o=this,i=t.webgl,n=t.collector,a=t.onload;(0,r.Z)(this,e),this.webgl=i,this.collector=n,this.name="bamboo",this.model=null,this.body=null,this.serial=0,this.enabled=!0,this.isTween=!1,this.offset={x:0,z:0},this.property={y:1.25,size:2,gap:.1,offset:{x:-2.1,z:-2.1},correction:{x:-.07,y:-.25,z:.115}},this.getOffset=function(){o.offset.x=1.6*Math.random()-.8,o.offset.z=1.6*Math.random()-.8},this.init(),this.addBamboo().then((function(){return a(o.name)})),this.randomPosition=function(){return Math.floor(9*Math.random())}}return(0,a.Z)(e,[{key:"init",value:function(){var e=this.property,t=e.y,o=e.gap,i=e.size,n=e.offset;this.position=(0,u.Z)(new Array(9).keys()).map((function(e){var r=Math.floor(e/3),a=e%3*i+e%3*o+n.x,s=Math.floor(e/3)*i+r*o+n.z;return{x:a,y:t,z:s}})),this.tweener=new f.default}},{key:"stop",value:function(){this.enabled=!1}},{key:"hide",value:function(){this.body.position.set(10,10,10),this.model.visible=!1}},{key:"setPositionByIndex",value:function(){var e=this;if(this.enabled&&!this.isTween){var t=z(this.collector.data.filter((function(e){return e.number>0&&""===e.hasItem}))),o=(0,i.Z)(t,1)[0].index;this.collector.setBambooIndex(o);var n=this.position[o];n.y=this.property.y-.6,this.tweener.stop().clearQueue().add({from:M(M({},n),{},{y:this.property.y-.6}),to:M(M({},n),{},{y:this.property.y}),duration:200,onStart:function(){e.getOffset(),e.model.visible=!0,e.isTween=!0},onUpdate:function(t){e.body.position.copy({x:t.x+e.offset.x,y:t.y,z:t.z+e.offset.z})},onComplete:function(t){e.body.position.copy({x:t.x+e.offset.x,y:t.y,z:t.z+e.offset.z}),e.isTween=!1}}).play()}}},{key:"addPhysics",value:function(){var e=this.webgl,t=e.world,o=e.physicsStaticMaterial,i=new l.Cylinder(.1,.16,.5,16,1);this.body=new l.Body({mass:100,shape:i,type:l.Body.STATIC,material:o}),this.body.name=this.name,this.hide(),t.addBody(this.body)}},{key:"addBamboo",value:function(){var e=this;return new Promise((function(t,o){(0,d.Z)(k).then((function(o){var i=o.model;o.gltf.scene.traverse((function(e){e.isMesh&&(e.castShadow=!0)})),i.scale.set(.6,.6,.6),e.webgl.scene.add(i),e.model=i,e.addPhysics(),t()})).catch(o)}))}},{key:"visible",value:function(e){this.model.visible=e}},{key:"update",value:function(e){if(this.model){var t=O(e);t!==this.serial&&(this.serial=t,this.setPositionByIndex());var o=this.body.position,i=this.property.correction;this.model.position.copy({x:o.x+i.x,y:o.y+i.y,z:o.z+i.z}),this.model.quaternion.copy(this.body.quaternion)}}}]),e}(),C=o.p+"bundle/model/character.glb";function Z(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function B(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(o),!0).forEach((function(t){(0,h.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Z(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var D=function(){function e(t){var o=this,i=t.webgl,n=t.onMushroomTrigger,a=t.onGameOver,s=t.onload;(0,r.Z)(this,e),this.webgl=i,this.onMushroomTrigger=n,this.onGameOver=a,this.name="character",this.model=null,this.mixer=null,this.actions={},this.actionName="idle",this.delta=.03,this.speed=.08,this.isOut=!1,this.moveable=!0,this.property={size:2,position:{x:0,y:1.6,z:0},correction:{x:0,y:-.6,z:0}},this.addCharacter().then((function(){o.actions[o.actionName].play(),s(o.name)})),this.update()}return(0,a.Z)(e,[{key:"setMoveable",value:function(e){this.moveable=e,this.stop()}},{key:"down",value:function(){this.doActionByName("down")}},{key:"wave",value:function(){this.isOut||this.doActionByName("wavehand")}},{key:"walk",value:function(){this.isOut||this.doActionByName("run")}},{key:"stop",value:function(){this.model&&!this.isOut&&this.doActionByName("idle")}},{key:"rotate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new m._fP;t.setFromAxisAngle(new m.Pa4(0,1,0).normalize(),e),this.model.rotation.setFromQuaternion(t)}},{key:"doActionByName",value:function(e){e!==this.actionName&&(this.actionName&&this.actions[this.actionName].stop(),this.actions[e].play(),this.actionName=e)}},{key:"addPhysics",value:function(){var e=this,t=this.webgl,o=t.world,i=t.physicsImpactMaterial,n=new l.Sphere(.6);this.body=new l.Body({mass:3,shape:n,type:l.Body.DYNAMIC,material:i}),this.body.position.copy(this.property.position),this.body.addEventListener("collide",(function(t){var o=t.body.name,i=t.target;if("box"===o)return i.velocity.setZero(),void(e.moveable||(e.moveable=!0));if("bamboo"===o){var n=t.body.position,r=i.position,a={x:-5*(n.x-r.x),z:-5*(n.z-r.z),y:5};i.velocity.setZero(),e.setMoveable(!1),requestAnimationFrame((function(){i.velocity.set(a.x,a.y,a.z)}))}else t.body.position.y=-1,i.velocity.setZero(),e.onMushroomTrigger()})),o.addBody(this.body)}},{key:"addCharacter",value:function(){var e=this;return new Promise((function(t,o){(0,d.Z)(C).then((function(o){var i=o.model,n=o.gltf;n.scene.traverse((function(e){var t=e;t.isMesh&&(t.castShadow=!0)})),e.mixer=new m.Xcj(n.scene),n.animations.forEach((function(t){var o=t.name,i=e.mixer.clipAction(t);e.actions[o.toLowerCase()]=i})),i.scale.set(.6,.6,.6),e.webgl.scene.add(i),e.model=i,e.addPhysics(),t()})).catch(o)}))}},{key:"visible",value:function(e){this.model.visible=e}},{key:"move",value:function(e){if(!this.isOut&&this.moveable&&(this.body||this.model)){var t=e.ArrowLeft,o=void 0===t?0:t,i=e.ArrowRight,n=void 0===i?0:i,r=e.ArrowUp,a=void 0===r?0:r,s=e.ArrowDown,c=o-n,h=a-(void 0===s?0:s),u={"00":!1,10:-Math.PI/2,"-10":Math.PI/2,"01":Math.PI,"0-1":0,"-11":Math.PI/4*3,11:-Math.PI/4*3,"1-1":-Math.PI/4,"-1-1":Math.PI/4}["".concat(c).concat(h)];!1!==u?(this.rotate(u),this.walk()):this.stop();var l=B({},this.body.position);l.x-=c*this.speed,l.z-=h*this.speed,this.body.velocity.x=0,this.body.velocity.z=0,this.body.position.x=l.x,this.body.position.z=l.z}}},{key:"update",value:function(){if(this.model){var e,t=this.body.position,o=this.property.correction,i=B({},t);if(i.x+=o.x,i.y+=o.y,i.z+=o.z,this.model.position.copy(i),null===(e=this.mixer)||void 0===e||e.update(this.delta),this.isOut)return;t.y<=1.4&&(this.isOut=!0,this.down(),this.onGameOver())}}}]),e}(),A=function(){function e(t){var o=t.character,i=t.bamboo,n=t.mushroom,a=t.cubes,s=t.onCollide;(0,r.Z)(this,e),this.character=o,this.bamboo=i,this.mushroom=n,this.cubes=a,this.onCollide=s,this.enabled=!0,this.direct={},this.speed=1,this.addEvents()}return(0,a.Z)(e,[{key:"stop",value:function(){this.enabled=!1}},{key:"addEvents",value:function(){var e=this;window.addEventListener("keydown",(function(t){if(e.enabled){var o=t.key;switch(o){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":e.direct[o]=1}}})),window.addEventListener("keyup",(function(t){var o=t.key;switch(o){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":e.direct[o]=0}}))}}]),e}(),S=o(5861),I=o(4687),E=o.n(I),T=function(){var e=(0,S.Z)(E().mark((function e(t){var o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new m.dpR,e.abrupt("return",new Promise((function(e,i){o.load(t,(function(t){e(t)}),i)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=T,L=o.p+"bundle/image/pages/game/webgl/texture/cube-top.jpg",N=o.p+"bundle/image/pages/game/webgl/texture/cube-side.jpg",_=function(){function e(t){var o=this,i=t.webgl,n=t.onload;(0,r.Z)(this,e),this.webgl=i,this.name="box",this.onload=n,this.numberOfBox=9,this.size=2,this.gapSize=.1,this.data=(0,u.Z)(new Array(this.numberOfBox).keys()).map((function(){return Math.floor(Math.random()*o.numberOfBox)})),this.addBoxes()}var t;return(0,a.Z)(e,[{key:"addPhysics",value:function(e){var t=e.col,o=e.row,i=e.i,n=this.webgl,r=n.world,a=n.physicsStaticMaterial,s=new l.Vec3(1,1,1),c=new l.Box(s),h=new l.Body({mass:0,shape:c,type:l.Body.STATIC,material:a}),u=1*(this.size+this.gapSize),d=1*(this.size+this.gapSize),f=i%3*this.size+o*this.gapSize-u,m=Math.floor(i/3)*this.size+t*this.gapSize-d;h.position.set(f,0,m),h.name="box",r.addBody(h)}},{key:"addBoxes",value:(t=(0,S.Z)(E().mark((function e(){var t,o,i,n,r=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(L);case 2:return t=e.sent,e.next=5,G(N);case 5:o=e.sent,t.wrapS=m.rpg,t.wrapT=m.rpg,t.repeat.set(1,.1),i=this.webgl.scene,n=new m.ZAu,this.boxes=(0,u.Z)(new Array(this.numberOfBox).keys()).map((function(e){var i=new m.DvJ(r.size,r.size,r.size),a=new m.YBo({color:1641989}),s=new m.Wid({map:t.clone()}),c=new m.Wid({map:o});s.map.offset.set(0,.1*r.data[e]);var h=new m.Kj0(i,[c,c,s,a,c,c]),u=Math.floor(e/3),l=e%3,d=e%3*r.size+l*r.gapSize,f=Math.floor(e/3)*r.size+u*r.gapSize;return h.receiveShadow=!0,h.position.set(d,0,f),n.add(h),r.addPhysics({col:u,row:l,i:e}),h})),n.position.x=0-1*(this.size+this.gapSize),n.position.z=0-1*(this.size+this.gapSize),i.add(n),this.onload(this.name);case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"visible",value:function(e){this.boxes.forEach((function(t){t.visible=e}))}}]),e}(),U=o.p+"bundle/model/mushroom.glb";function R(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function F(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?R(Object(o),!0).forEach((function(t){(0,h.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):R(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var W=function(){function e(t){var o=this,i=t.webgl,n=t.collector,a=t.onload;(0,r.Z)(this,e),this.webgl=i,this.collector=n,this.name="mushroom",this.models=[],this.bodies=[],this.serial=0,this.enabled=!0,this.offset={x:0,z:0},this.getOffset=function(){o.offset.x=1.6*Math.random()-.8,o.offset.z=1.6*Math.random()-.8},this.property={index:5,y:1.25,size:2,gap:.1,offset:{x:-2.1,z:-2.1},correction:{x:-.08,y:-.25,z:.095}},this.init(),this.addMushroom().then((function(){return a(o.name)})),this.randomPosition=function(){return Math.floor(9*Math.random())}}return(0,a.Z)(e,[{key:"stop",value:function(){this.enabled=!1}},{key:"init",value:function(){var e=this.property,t=e.y,o=e.size,i=e.gap,n=e.offset;this.position=(0,u.Z)(new Array(9).keys()).map((function(e){var r=Math.floor(e/3),a=e%3*o+e%3*i+n.x,s=Math.floor(e/3)*o+r*i+n.z;return{x:a,y:t,z:s}})),this.tweeners=(0,u.Z)(new Array(v.maxMushroom).keys()).map((function(){return new f.default}))}},{key:"setPositionByIndex",value:function(){var e=this;if(this.enabled){var t=z(this.collector.data.filter((function(e){return e.number>0&&""===e.hasItem}))),o=(0,i.Z)(t,1)[0].index;this.collector.setMushroomIndex(o);var n=this.position[o];n.y=this.property.y-.6;var r=this.serial%v.maxMushroom,a=this.tweeners[r],s=this.bodies[r];a.stop().clearQueue().add({from:F(F({},n),{},{y:this.property.y-.6}),to:F(F({},n),{},{y:this.property.y}),duration:200,onStart:function(){return e.getOffset()},onUpdate:function(t){s.position.copy({x:t.x+e.offset.x,y:t.y,z:t.z+e.offset.z})},onComplete:function(t){s.position.copy({x:t.x+e.offset.x,y:t.y,z:t.z+e.offset.z})}}).play()}}},{key:"addPhysics",value:function(){var e=this,t=this.webgl,o=t.world,i=t.physicsStaticMaterial,n=new l.Cylinder(.16,.16,.5,16,1);this.bodies=(0,u.Z)(new Array(v.maxMushroom).keys()).map((function(){var t=new l.Body({mass:0,shape:n,type:l.Body.STATIC,material:i});return t.name=e.name,o.addBody(t),t}))}},{key:"addMushroom",value:function(){var e=this;return new Promise((function(t,o){(0,d.Z)(U).then((function(o){var i=o.model;o.gltf.scene.traverse((function(e){var t=e;t.isMesh&&(t.castShadow=!0)})),i.scale.set(.6,.6,.6),e.models=(0,u.Z)(new Array(v.maxMushroom).keys()).map((function(){var t=i.clone();return e.webgl.scene.add(t),t})),e.addPhysics(),e.setPositionByIndex(),t()})).catch(o)}))}},{key:"visible",value:function(e){this.models.forEach((function(t){t.visible=e}))}},{key:"update",value:function(e){var t=this;if(0!==this.models.length){var o=O(e,"linear");o!==this.serial&&(this.serial=o,this.setPositionByIndex()),(0,u.Z)(new Array(v.maxMushroom).keys()).forEach((function(e){var o=t.models[e],i=t.bodies[e].position,n=t.property.correction;o.position.copy({x:i.x+n.x,y:i.y+n.y,z:i.z+n.z})}))}}}]),e}(),q=function(){function e(){(0,r.Z)(this,e),this.data=(0,u.Z)(v.cubes),this.bambooName="bamboo",this.mushroomName="mushroom"}return(0,a.Z)(e,[{key:"setBambooIndex",value:function(e){var t=this;this.data.forEach((function(e){e.hasItem===t.bambooName&&(e.hasItem="")})),this.data.forEach((function(o){o.index===e&&(o.hasItem=t.bambooName)}))}},{key:"setMushroomIndex",value:function(e){var t=this;this.data.forEach((function(e){e.hasItem===t.mushroomName&&(e.hasItem="")})),this.data.forEach((function(o){o.index===e&&(o.hasItem=t.mushroomName)}))}}]),e}(),Q=function(){function e(t){var o=this,i=t.dom,n=t.onMushroomTrigger,a=t.onModulesLoaded,s=t.onGameTimeUp,h=t.onGameOver;(0,r.Z)(this,e),this.webgl=new c.Z(p),this.webgl.controls.controls.enablePan=!1,i.appendChild(this.webgl.render.domElement),this.onMushroomTrigger=n,this.onModulesLoaded=a,this.onGameTimeUp=s,this.onGameOver=h,this.enabled=!1,this.collector=new q,this.cubes=null,this.character=null,this.mushroom=null,this.bamboo=null,this.controller=null,this.loaderData={},this.onGLBLoaded=function(e){o.loaderData[e]=!0,Object.keys(o.loaderData).length>=4&&(a(),o.addController(),o.update())},this.firstDelta=!1,this.addGUI(),this.addCubes(),this.addCharacter(n,h),this.addMushroom(),this.addBamboo(),window.addEventListener("resize",(function(){var e=o.webgl,t=e.camera,i=e.renderer;t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),i.renderer.setSize(window.innerWidth,window.innerHeight)}),!1)}return(0,a.Z)(e,[{key:"addController",value:function(){var e=this.webgl,t=this.cubes,o=this.character,i=this.mushroom,n=this.bamboo;this.controller=new A({webgl:e,cubes:t,character:o,mushroom:i,bamboo:n})}},{key:"addBamboo",value:function(){this.bamboo=new j({webgl:this.webgl,collector:this.collector,onload:this.onGLBLoaded})}},{key:"addMushroom",value:function(){this.mushroom=new W({webgl:this.webgl,collector:this.collector,onload:this.onGLBLoaded})}},{key:"addCharacter",value:function(e,t){this.character=new D({webgl:this.webgl,onMushroomTrigger:e,onGameOver:t,onload:this.onGLBLoaded})}},{key:"addCubes",value:function(){this.cubes=new _({webgl:this.webgl,onload:this.onGLBLoaded})}},{key:"addGUI",value:function(){var e=this,t=new s.XS,o=Object.fromEntries(Object.entries(this.webgl.sky.sky.material.uniforms).filter((function(e){return"up"!==e[0]&&"sunPosition"!==e[0]})).map((function(e){return[e[0],e[1].value]})));o.exposure=this.webgl.renderer.renderer.toneMappingExposure,o.azimuth=this.webgl.sky.options.azimuth,o.inclination=this.webgl.sky.options.inclination;var i=function(){var t=e.webgl.sky.sky.material.uniforms;t.turbidity.value=o.turbidity,t.rayleigh.value=o.rayleigh,t.mieCoefficient.value=o.mieCoefficient,t.mieDirectionalG.value=o.mieDirectionalG,e.webgl.renderer.renderer.toneMappingExposure=o.exposure,e.webgl.sky.options.azimuth=o.azimuth,e.webgl.sky.options.inclination=o.inclination,e.webgl.sky.update()},n=t.addFolder("sky");n.add(o,"turbidity",0,20,.1).onChange(i),n.add(o,"rayleigh",0,4,.001).onChange(i),n.add(o,"mieCoefficient",0,4,.001).onChange(i),n.add(o,"mieDirectionalG",0,4,.001).onChange(i),n.add(o,"azimuth",0,Math.PI/2,.001).onChange(i),n.add(o,"inclination",0,Math.PI/2,.001).onChange(i),n.add(o,"exposure",0,1,.001).onChange(i)}},{key:"update",value:function(){var e=this,t=this.webgl,o=t.enterframe,i=t.stats;o.add((function(t){var o,n,r,a,s=t.delta,c=v.totalDuration;!1===e.firstDelta&&(e.firstDelta=s);var h=s-e.firstDelta;e.character.move(e.controller.direct),null===(o=e.cannonDebugger)||void 0===o||o.update(),null===(n=e.bamboo)||void 0===n||n.update(h),null===(r=e.mushroom)||void 0===r||r.update(h),null===(a=e.character)||void 0===a||a.update(),h>c&&!1===e.enabled&&(e.enabled=!0,e.onGameTimeUp(),e.character.stop(),e.controller.stop(),e.bamboo.stop(),e.mushroom.stop()),i.end()}))}}]),e}(),H=o(1509),X=o(3032),Y=o(5893),J=(0,n.memo)((function(){var e=(0,n.useContext)(H._y),t=(0,i.Z)(e,2)[1],o=(0,n.useRef)(),r=(0,n.useState)(0),a=(0,i.Z)(r,2),s=a[0],c=a[1];(0,n.useEffect)((function(){s&&t({type:X.om.modal,state:{enabled:!0,body:"吃到 ".concat(s," 蘑菇了")}})}),[s]);var h=(0,n.useCallback)((function(){t({type:X.om.loadingProcess,state:{enabled:!1}})}),[]),u=(0,n.useCallback)((function(){c((function(e){return e+1}))}),[]),l=(0,n.useCallback)((function(){t({type:X.om.modal,state:{enabled:!0,body:"時間到了",time:1e4}})}),[]),d=(0,n.useCallback)((function(){t({type:X.om.modal,state:{enabled:!0,body:"出界了",time:1e4}})}),[]);return(0,n.useEffect)((function(){t({type:X.om.loadingProcess,state:{enabled:!0}});var e=new Q({dom:o.current,onMushroomTrigger:u,onModulesLoaded:h,onGameTimeUp:l,onGameOver:d});return function(){return e.webgl.enterframe.stop()}}),[]),(0,Y.jsx)("div",{ref:o,className:"h-full w-full"})}))}}]);