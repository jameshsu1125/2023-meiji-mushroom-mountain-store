"use strict";(self.webpackChunk_2023_meiji_mushroom_mountain_store=self.webpackChunk_2023_meiji_mushroom_mountain_store||[]).push([[890],{9890:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var n=i(7294),a=i(5671),r=i(3144),s=i(4376),o=i(1214),u=i(9477),l={fps:0,camera:{fov:50,far:75,type:i(5444).CameraType.perspective},sky:{enabled:!0,turbidity:3.6,rayleigh:.165,mieCoefficient:0,mieDirectionalG:.768,inclination:.25,azimuth:.25},controls:{distance:{min:13,max:30},polar:{min:-70,max:70},azimuth:{min:-1/0,max:1/0},default:{polar:50,azimuth:35},offsetAzimuth:0,enabled:!0,panEasing:100},light:{ambient:{color:13163508,intensity:1},point:{color:16042184,intensity:.9,distance:100,decay:.5,position:{x:0,y:8,z:0}},shadowMapSize:512,debug:!0},renderer:{alpha:!1,shadowType:u.ntZ,exposure:1,outputEncoding:u.knz,physicallyCorrectLights:!1},physics:!1,stats:!0},c=i(5861),h=i(2982),d=i(4687),p=i.n(d),f=function(){var e=(0,c.Z)(p().mark((function e(t){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new u.dpR,e.abrupt("return",new Promise((function(e,n){i.load(t,(function(t){e(t)}),n)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=f,g=i.p+"bundle/image/pages/game/webgl/texture/cube-top.jpg",w=i.p+"bundle/image/pages/game/webgl/texture/cube-side.jpg",b=function(){function e(t){var i=this,n=t.webgl;(0,a.Z)(this,e),this.webgl=n,this.numberOfBox=9,this.size=2,this.gapSize=.1,this.data=(0,h.Z)(new Array(this.numberOfBox).keys()).map((function(){return Math.floor(Math.random()*i.numberOfBox)})),this.addBox()}var t;return(0,r.Z)(e,[{key:"addBox",value:(t=(0,c.Z)(p().mark((function e(){var t,i,n,a,r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(g);case 2:return t=e.sent,e.next=5,m(w);case 5:i=e.sent,t.wrapS=u.rpg,t.wrapT=u.rpg,t.repeat.set(1,.1),n=this.webgl.scene,a=new u.ZAu,this.boxes=(0,h.Z)(new Array(this.numberOfBox).keys()).map((function(e){var n=new u.DvJ(r.size,r.size,r.size),s=new u.YBo({color:1641989}),o=new u.Wid({map:t.clone()}),l=new u.Wid({map:i});o.map.offset.set(0,.1*r.data[e]);var c=new u.Kj0(n,[l,l,o,s,l,l]),h=Math.floor(e/3),d=e%3,p=e%3*r.size+d*r.gapSize,f=Math.floor(e/3)*r.size+h*r.gapSize;return c.receiveShadow=!0,c.position.set(p,0,f),a.add(c),c})),a.position.x=0-1*(this.size+this.gapSize),a.position.z=0-1*(this.size+this.gapSize),n.add(a);case 15:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),y=i(4570),v=i.p+"bundle/model/character.glb",x=function(){function e(t){var i=t.webgl;(0,a.Z)(this,e),this.webgl=i,this.mixers=[],this.index=1,this.addCharacter(),this.wave(),this.update()}return(0,r.Z)(e,[{key:"update",value:function(){var e=this;this.webgl.enterframe.add((function(){var t,i=e.webgl.clock.getDelta();null===(t=e.mixers[e.index])||void 0===t||t.update(i)}))}},{key:"wave",value:function(){this.index=2}},{key:"walk",value:function(){this.index=1}},{key:"addCharacter",value:function(){var e=this;(0,y.Z)(v).then((function(t){var i=t.model,n=t.mixers;t.gltf.scene.traverse((function(e){var t=e;t.isMesh&&(t.castShadow=!0)})),i.scale.set(.8,.8,.8),i.position.y=1,e.webgl.scene.add(i),e.mixers=n}))}}]),e}(),k=function(){function e(t){(0,a.Z)(this,e),this.webgl=new o.Z(l),this.cubes=null,this.character=null,t.appendChild(this.webgl.render.domElement),this.addGUI(),this.addCubes(),this.addCharacter()}return(0,r.Z)(e,[{key:"addCharacter",value:function(){this.character=new x({webgl:this.webgl})}},{key:"addCubes",value:function(){this.cubes=new b({webgl:this.webgl})}},{key:"addGUI",value:function(){var e=this,t=Object.fromEntries(Object.entries(this.webgl.sky.sky.material.uniforms).filter((function(e){return"up"!==e[0]&&"sunPosition"!==e[0]})).map((function(e){return[e[0],e[1].value]})));t.exposure=this.webgl.renderer.renderer.toneMappingExposure,t.azimuth=this.webgl.sky.options.azimuth,t.inclination=this.webgl.sky.options.inclination;var i=function(){var i=e.webgl.sky.sky.material.uniforms;i.turbidity.value=t.turbidity,i.rayleigh.value=t.rayleigh,i.mieCoefficient.value=t.mieCoefficient,i.mieDirectionalG.value=t.mieDirectionalG,e.webgl.renderer.renderer.toneMappingExposure=t.exposure,e.webgl.sky.options.azimuth=t.azimuth,e.webgl.sky.options.inclination=t.inclination,e.webgl.sky.update()},n=(new s.XS).addFolder("sky");n.add(t,"turbidity",0,20,.1).onChange(i),n.add(t,"rayleigh",0,4,.001).onChange(i),n.add(t,"mieCoefficient",0,4,.001).onChange(i),n.add(t,"mieDirectionalG",0,4,.001).onChange(i),n.add(t,"azimuth",0,Math.PI/2,.001).onChange(i),n.add(t,"inclination",0,Math.PI/2,.001).onChange(i),n.add(t,"exposure",0,1,.001).onChange(i)}}]),e}(),z=i(5893),C=(0,n.memo)((function(){var e=(0,n.useRef)();return(0,n.useEffect)((function(){new k(e.current)}),[]),(0,z.jsx)("div",{ref:e,className:"h-full w-full"})}))}}]);